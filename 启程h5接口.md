  

# **一** **api** 接口说明

## **1** api例子参考

传参方式： get

传参例子：

<http://www.gzfesco.cn/api/qcshcz/ballgame/step1/?sex=1>

非传参例子：

<http://www.gzfesco.cn/api/qcshcz/ballgame/step1/>（因为本次项目有用到微信，未防止浏览器地址会跳回redirect_url？code=xxxxx，**所以此处地址末尾最好要加/）

## **2** 返回json格式

| **参数** | **参数类型** | **参数说明**                     |
| -------- | ------------ | -------------------------------- |
| code     | int          | 20000代表成功通讯，40000代表失败 |
| message  | string       | 消息体                           |
| data     | array        | 返回的实际数据                   |

## **3** 代码code说明

| 代码(code) | **说明** |
| ---------- | -------- |
| 20000      | 通讯成功 |
| 40000      | 通讯失败 |

## 二 本次上海车展实际接口说明



## 0 微信用户注册信息接口

请求示例 ：<http://www.gzfesco.cn/api/qcshcz/qcshczh5/register/?openid=xxx&headimgurl=xxx&nickname=xxx>

| **参数**   | **取值范围** | **说明**           |
| ---------- | ------------ | ------------------ |
| headimgurl | 必填         | 微信头像           |
| openid     | 必填         | 对应着用户的openid |
| nickname   | 必填         | 微信昵称           |

正常返回示例：{"code":20000,"message":"successful connected","data":[{"openid":"sadasd","eid":84,"nickname":"222","headimgurl":"xsxx"}]}

| **参数**   | **取值范围** | **说明** |
| ---------- | ------------ | -------- |
| code       | 20000        |          |
| eid        |              | 用户id   |
| opendi     |              |          |
| nickname   |              | 微信昵称 |
| Headimgurl |              | 微信头像 |

失败返回示例：

| **参数** | **说明**                                    |
| -------- | ------------------------------------------- |
| code     | 40000，代表请求到达服务器，但有异常情况发生 |



## 1 **查询体验者互动项目体验状态接口**

请求示例 ：<http://www.gzfesco.cn/api/qcshcz/qcshczh5/playedproject/?pid=0&openid=xxx>

| **参数** | **取值范围** | **说明**                                                     |
| -------- | ------------ | ------------------------------------------------------------ |
| pid      | 0，2-4，6    | 0返回所有项目的体验结果。2-4返回指定项目的体验结果，2代表车家互动，3代表EV艺术，4代表EV智趣互动篮球，6代表智能驾驶舱体验结果 |
| openid   | 必填         | 对应着用户的openid                                           |

正常返回示例：{"code":20000,"message":"successful connected","data":[{"pid2":0,"pid3":0,"pid4":0,"pid6":0}]}

| **参数** | **取值范围** | **说明**                                                 |
| -------- | ------------ | -------------------------------------------------------- |
| pid2     | 0,1          | pid2代表车家互动体验项目。0代表没有体验过，1代表体验过。 |

失败返回示例：

| **参数** | **说明**                                    |
| -------- | ------------------------------------------- |
| code     | 40000，代表请求到达服务器，但有异常情况发生 |

## **2** **注册信息提交接口**

请求 ：<http://www.gzfesco.cn/api/qcshcz/qcshczh5/leaveinfo/?username=aaa&openid=xxx&tel=222>

| **参数** | **取值范围** | **说明**                 |
| -------- | ------------ | ------------------------ |
| openid   | 必填         | 对应着用户的openid       |
| username | 必填         | 对应着用户提交的姓名     |
| tel      | 必填         | 对应着用户提交的电话号码 |

正常返回示例：{"code":20000,"message":"successful connected","data":[{"openid":"xxx","eid":12,"nickname":"nickname","headimgurl":"http:\/\/thirdwx.qlogo.cn\/mmopen\/vi_32\/Q0j4TwGTfTJhhm0bvVPbT7VmZiaVOIEdrhrz8fMe8Ipo4L88eAicibibqIFCQuf8RrmU6Fzo7t6YDVaaOicx80kQnmQ\/132"}]}

| **参数**   | **取值范围** | **说明**       |
| ---------- | ------------ | -------------- |
| code       | 20000        |                |
| eid        |              | 用户id         |
| opendi     |              |                |
| nickname   |              | 微信昵称       |
| Headimgurl |              | 微信头像       |
| tel        |              | 用户的手机号码 |
| username   |              | 用户的注册名   |

失败返回示例：

| **参数** | **说明**                                                |
| -------- | ------------------------------------------------------- |
| code     | 40000，代表请求到达服务器，但有异常发生，如username重复 |

## **3** Ev智趣大挑战抽奖报名接口（在对应页面摇晃手机时调用）

请求 ：<http://www.gzfesco.cn/api/qcshcz/qcshczh5/shake/?openid=xxx>

| **参数** | **取值范围** | **说明**           |
| -------- | ------------ | ------------------ |
| openid   | 必填         | 对应着用户的openid |

正常返回示例：{"code":20000,"message":"xxxx"}

| **参数**   | **取值范围** | **说明** |
| ---------- | ------------ | -------- |
| code       | 20000        |          |
| eid        |              | 用户id   |
| opendi     |              |          |
| nickname   |              | 昵称     |
| Headimgurl |              | 头像     |

失败返回示例：

| **参数** | **说明**                                    |
| -------- | ------------------------------------------- |
| code     | 40000，代表请求到达服务器，但有异常情况发生 |
| code     | 40006, 游戏状态不对，不准入库               |

## **4** 礼品定制信息提交接口

请求 ：<http://www.gzfesco.cn/api/qcshcz/qcshczh5/custom_prize/?openid=xxx&fontid=2&str=whoami>&pid=3

| **参数** | **取值范围** | **说明**                                              |
| -------- | ------------ | ----------------------------------------------------- |
| openid   | 必填         | 对应着用户的openid                                    |
| fontid   | 1-4          | 微软雅黑为1，平方简体为2，梦娜字体为3，思源黑体为4。  |
| str      | 必填         | xxx为玩家定义的字符串                                 |
| pid      | 必填         | 对应着项目id（此处应为3,6对应着EV艺术灯，太空舱项目） |

正常返回示例：{"code":20000,"message":"xxxx"}

| **参数** | **取值范围** | **说明** |
| -------- | ------------ | -------- |
| code     | 20000        |          |

失败返回示例：

| **参数** | **说明**                                    |
| -------- | ------------------------------------------- |
| code     | 40000，代表请求到达服务器，但有异常情况发生 |

## **5** 领奖信息获取接口（请求有无定制礼品，有无中奖）

请求 ：<http://www.gzfesco.cn/api/qcshcz/qcshczh5/scanqrcode_prize/?openid=xxx&pid=2>

| **参数** | **取值范围** | **说明**                                  |
| -------- | ------------ | ----------------------------------------- |
| openid   | 必填         | 对应着用户的openid                        |
| pid      | 必填，2,6    | 2对应着车家互动的项目id,6对应着太空舱项目 |

正常返回示例：{"code":20000,"message":"successful connected","data":[{"iscustom":0,"isaward":1}]}

| **参数** | **取值范围** | **说明**                   |
| -------- | ------------ | -------------------------- |
| code     | 20000        |                            |
| iscustom | 有无定制礼品 | 0代表没定制，1代表已定制   |
| isaward  | 有无领过奖品 | 0代表没有领过，1代表已领过 |

失败返回示例：

| **参数** | **说明**                                    |
| -------- | ------------------------------------------- |
| code     | 40000，代表请求到达服务器，但有异常情况发生 |

## **6** 获取用户图片接口

请求 ： http://www.gzfesco.cn/api/qcshcz/qcshczh5/getuserimage/?eid=12&pid=3

| **参数** | **取值范围** | **说明** |
| -------- | ------------ | -------- |
| eid      | 必填         | 用户id   |
| pid      | 必填         | 项目id   |

{"code":20000,"message":"successful connected","data":[{"object":"aaaa.jpg","aliyun":"http:\/\/venucia2019.oss-cn-shanghai.aliyuncs.com\/","pid":3},{"object":"aaaa.jpg","aliyun":"http:\/\/venucia2019.oss-cn-shanghai.aliyuncs.com\/","pid":3}]}

| **参数** | **取值范围** | **说明**             |
| -------- | ------------ | -------------------- |
| object   |              | 文件名（如aa.jpg）   |
| aliyun   |              | 阿里云展示图片的域名 |
| pid      |              | 返回项目id           |

失败返回示例：

| **参数** | **说明**                                           |
| -------- | -------------------------------------------------- |
| code     | 40000，代表请求到达服务器，如数据库找不到用户的eid |

## 7 ev艺术灯为他打call接口

![img](file:///C:\Users\ADMINI~1\AppData\Local\Temp\ksohtml\wpsFE53.tmp.png)![img](file:///C:\Users\ADMINI~1\AppData\Local\Temp\ksohtml\wpsFE54.tmp.png)![img](file:///C:\Users\ADMINI~1\AppData\Local\Temp\ksohtml\wpsFE65.tmp.png)请求 ： <http://www.gzfesco.cn/api/qcshcz/qcshczh5/call/?openid=xxx&fromopenid=yyy>

| **参数**   | **取值范围** | **说明**             |
| ---------- | ------------ | -------------------- |
| openid     | 必填         | 对应着用户的openid   |
| fromopenid | 必填         | 对应着加油人的openid |

正常返回示例：{"code":20000,"message":"xxxx"}

| **参数** | **取值范围** | **说明** |
| -------- | ------------ | -------- |
| code     | 20000        |          |

失败返回示例：

| **参数** | **说明**                                                     |
| -------- | ------------------------------------------------------------ |
| code     | 40000，代表请求到达服务器，但有异常情况发生或者根据openid，找不到用户的eid |

## **8** ev艺术灯榜单接口

请求 ：<http://www.gzfesco.cn/api/qcshcz/qcshczh5/page/?page=1> 

{"code":20000,"message":"successful connected","data":[{"id":"1","ownerurl":"","headimgurl":"","eid":"12","fromopenid":"fromopenid"},{"id":"2","ownerurl":"","headimgurl":"","eid":"12","fromopenid":"fromopenid"},{"id":"3","ownerurl":"","headimgurl":"","eid":"12","fromopenid":"fromopenid"},{"id":"4","ownerurl":"","headimgurl":"","eid":"12","fromopenid":"123456778"},{"id":"5","ownerurl":"","headimgurl":"","eid":"12","fromopenid":"123456778"}]}

| **参数** | **取值范围** | **说明**                                                     |
| -------- | ------------ | ------------------------------------------------------------ |
| page     | 1-n          | 对应着数据库的页数，如page=1，则返回1-5条数据，page=2，则返回第6-10条数据 |

正常返回示例：{"code":20000,"message":"xxxx"}

| **参数**   | **取值范围** | **说明**           |
| ---------- | ------------ | ------------------ |
| code       | 20000        |                    |
| eid        |              | 被加油的用户eid    |
| fromopenid |              | 加油者的openid     |
| ownerurl   |              | 暂定为空           |
| headimgurl |              | 被加油者的微信头像 |

失败返回示例：

| **参数** | **说明**                                    |
| -------- | ------------------------------------------- |
| code     | 40000，代表请求到达服务器，但有异常情况发生 |

## 9 ev艺术灯生成2维码接口

请求 ： http://www.gzfesco.cn/api/qcshcz/qcshczh5/qrcode/?url=xxx&openid=yyy

| **参数** | **取值范围** | **说明**                                                     |
| -------- | ------------ | ------------------------------------------------------------ |
| url      | 必填         | 你们h5方需要的url，就是扫码后出现为他加油的页面的url。比如www.baidu.com |
| openid   | 必填         | 被加油者的openid                                             |

 

用户扫码该2维码后，实际打开的url如下：

http://www.gzfesco.cn/api/qcshcz/qcshczh5/authorize/?url=www.baidu.com?openid=yyy

该url自动经过微信授权跳转后，最终跳回到：

http://www.baidu.com/?openid=yyy&newopenid=oZPt5t_bNafqeH-IFVIi_ewteOps&nickname=%E9%98%BF%E6%AD%A6&headimgurl=http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJhhm0bvVPbT7VmZiaVOIEdrhrz8fMe8Ipo4L88eAicibibqIFCQuf8RrmU6Fzo7t6YDVaaOicx80kQnmQ/132&from=844b&vit=fps

| **参数**   | **取值范围** | **说明**         |
| ---------- | ------------ | ---------------- |
| openid     |              | 被加油者的openid |
| newopenid  |              | 加油者的openid   |
| headimgurl |              | 加油者的头像     |
| nickname   |              | 加油者的昵称     |

 

## 10 华容道记录（游戏开始前调用一下该接口，传finished=0）

请求 ：[http://www.gzfesco.cn/api/qcshcz/qcshczh5/answerrecord/?elapsedtime=21&eid=12&finished=1](http://www.gzfesco.cn/api/qcshcz/carhome/answerrecord/?elapsedtime=21&eid=12&finished=1&points=2)

| **参数**    | **取值范围** | **说明**                      |
| ----------- | ------------ | ----------------------------- |
| elapsedtime | int          | 用户本次华容道的耗时 秒为单位 |
| eid         |              | 用户的id                      |
| finished    | 0-1          | 用户是否完成华容道体验        |

正常返回示例：

{"code":20000,"message":"successful connected","data":[]}

| **参数** | **取值范围** | **说明**     |
| -------- | ------------ | ------------ |
| code     | 20000        | 代表正常入库 |

失败返回示例：

{"code":40000,"message":"exception happend,please contact administrator","data":[]}

## 11  华容道排行榜

请求 ：[http://www.gzfesco.cn/api/qcshcz/qcshczh5/chart/?page=1&perpage=5](http://www.gzfesco.cn/api/qcshcz/carhome/chart/?page=1&perpage=5)

| **参数** | **取值范围** | **说明**           |
| -------- | ------------ | ------------------ |
| page     | int          | 第几页，默认第一页 |
| perpage  | int          | 每一页多少条数据   |

正常返回示例：

{"code":20000,"message":"successful connected","data":[{"eid":12,"elapsedtime":21,"mingci":1,"nickname":"nickname","headimgurl":"http:\/\/thirdwx.qlogo.cn\/mmopen\/vi_32\/Q0j4TwGTfTJhhm0bvVPbT7VmZiaVOIEdrhrz8fMe8Ipo4L88eAicibibqIFCQuf8RrmU6Fzo7t6YDVaaOicx80kQnmQ\/132","openid":"xxx"}]}

| **参数**    | **取值范围** | **说明**         |
| ----------- | ------------ | ---------------- |
| eid         |              | 用户的id         |
| openid      |              | 用户的微信openid |
| nickname    |              | 用户的微信昵称   |
| headimgurl  |              | 用户的微信头像   |
| mingci      |              | 第几名。         |
| elapsedtime |              | 耗时，秒         |

失败返回示例：

{"code":40000,"message":"exception happend,please contact administrator","data":[]}

## 三 授权中转页面（扫码注册接口）

[**http://www.gzfesco.cn/api/qcshcz/qcshczh5/authorize2/?url=www.baidu.com?pid=5**](http://www.gzfesco.cn/wechat/transfer/authorize/?url=www.baidu.com?pid=3)

| **参数** | **取值范围** | **说明**                                         |
| -------- | ------------ | ------------------------------------------------ |
| URl      | 必填         | 地址，你们h5给地址，这是代表h5方获取openid的地址 |
| pid      | 必填         | 对应着项目id                                     |



## 四 图片上传接口

1 图片上传接口

<http://www.gzfesco.cn/wechat/image/upload>

http://www.gzfesco.cn/wechat/image/upload_base64

2 上传方式示例（ajax）

![img](file:///C:\Users\ADMINI~1\AppData\Local\Temp\ksohtml\wpsFE6A.tmp.jpg) 

![img](file:///C:\Users\ADMINI~1\AppData\Local\Temp\ksohtml\wps775D.tmp.jpg)

3 字段要求

| 参数                | 参数范围 | 说明               |
| ------------------- | -------- | ------------------ |
| pid                 |          | 项目id             |
| eid                 |          | 用户id             |
| file或者file_base64 | 必传     | 文件或者base64文件 |
| openid              | 必传     | 微信用户id         |

4 正常返回（图片的oss访问地址）

{"code":20000,"message":"successful connected","data":[{"url":"http:\/\/venucia2019.oss-cn-shanghai.aliyuncs.com\/15513419800563.jpg"}]}

5 失败返回

{"code":40000,"message":"xxxx"}











 

 