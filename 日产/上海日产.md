  

[TOC]

# 一 api 接口说明

## **1** api例子参考

传参方式： get

传参例子：

<http://www.gzfesco.cn/api/qcshcz/ballgame/step1/?sex=1>

非传参例子：

<http://www.gzfesco.cn/api/qcshcz/ballgame/step1/>（因为本次项目有用到微信，未防止浏览器地址会跳回redirect_url？code=xxxxx，**所以此处地址末尾最好要加/）

## **2** 返回json格式

| **参数** | **参数类型** | **参数说明**                     |
| -------- | ------------ | -------------------------------- |
| code     | int          | 20000代表成功通讯，40000代表失败 |
| message  | string       | 消息体                           |
| data     | array        | 返回的实际数据                   |

## **3** 代码code说明

| 代码(code) | **说明** |
| ---------- | -------- |
| 20000      | 通讯成功 |
| 40000      | 通讯失败 |

## 4 本次上海车展id说明

| id     | 说明                       |
| ------ | -------------------------- |
| openid | 微信的id                   |
| pid    | 代表项目的id               |
| eid    | 代表用户的id，数据库中唯一 |

## 5 本次上海车展项目id约定

| 名称                 | pid  |
| -------------------- | ---- |
| 新车合影小程序       | 8    |
| Tshirt定制拍照       | 9    |
| 日产上海车展小程序   | 10   |
| 主舞台ar（智能互联） | 11   |
| ar寻宝(智能出行)     | 12   |
| vr探秘               | 13   |

# 二 本次上海车展实际接口说明

## 0 通用接口程序

##### a 根据openid判断是否注册信息接口（有没有填入用户名和手机号）

请求 ：http://www.gzfesco.cn/api/rcshcz/common/isreg/?openid=xxx

| **参数** | **取值范围** | **说明** |
| -------- | ------------ | -------- |
| openid   |              | 微信id   |

正常返回示例：{"code":20000,"message":"xxxx"}

| **参数**（字段code） | **取值范围** | **说明** |
| -------------------- | ------------ | -------- |
| 20012                |              | 没注册   |
| 20013                |              | 已注册   |

| **参数**（字段data，当code=20013的时候返回） | **取值范围** | **说明**     |
| -------------------------------------------- | ------------ | ------------ |
| openid                                       |              | 微信id       |
| nickname                                     |              | 微信昵称     |
| headimgurl                                   |              | 微信头像     |
| username                                     |              | 注册用户名   |
| tel                                          |              | 注册电话号码 |

失败返回示例：

| 参数 | 说明                                        |
| ---- | ------------------------------------------- |
| code | 40000，代表请求到达服务器，但有异常情况发生 |

##### b 注册信息提交接口

请求 ：http://www.gzfesco.cn/api/rcshcz/common/register/?openid=xxx&nickname=xxx&headimgurl=xxx&province=xx&city=city&firstplace=xxx&username=sss&tel=sss

| **参数**   | **取值范围** | **说明**     |
| ---------- | ------------ | ------------ |
| openid     |              | 微信id       |
| nickname   |              | 微信昵称     |
| headimgurl |              | 微信头像     |
| username   |              | 注册用户名   |
| tel        |              | 注册电话号码 |
| province   |              | 省           |
| city       |              | 市           |
| firstplace |              | 4s店         |

正常返回示例：{"code":20000,"message":"xxxx"}

| **参数**（字段code） | **取值范围** | **说明**             |
| -------------------- | ------------ | -------------------- |
| 20010                |              | 插入数据库成功       |
| 20011                |              | 数据库已存在该openid |

| **参数**（字段data） | **取值范围** | **说明**     |
| -------------------- | ------------ | ------------ |
| openid               |              | 微信id       |
| nickname             |              | 微信昵称     |
| headimgurl           |              | 微信头像     |
| username             |              | 注册用户名   |
| tel                  |              | 注册电话号码 |
| province             |              | 省           |
| city                 |              | 市           |
| firstplace           |              | 4s店         |
| eid                  |              | 用户的id     |

失败返回示例：

| **参数** | **说明**                                    |
| -------- | ------------------------------------------- |
| code     | 40000，代表请求到达服务器，但有异常情况发生 |

##### c 获取省市4s店接口（待给出省市店的数据）



## 1 日产上海车展小程序



## 2 主舞台ar（智能互联）



## 3 ar寻宝(智能出行)

##### a 咖啡游戏开启接口（首页的领取咖啡或者重新体验按钮）（如果重复调用该接口，意味着重新开启新一轮游戏）

请求 ：http://www.gzfesco.cn/api/rcshcz/common/startgame/?openid=xxx

| **参数** | **取值范围** | **说明** |
| -------- | ------------ | -------- |
| openid   |              | 微信id   |

正常返回示例：{"code":20000,"message":"xxxx"}

| **参数**（字段code） | **取值范围** | **说明** |
| -------------------- | ------------ | -------- |
| 20000                |              | 游戏开启 |

失败返回示例：

| **参数** | **说明**              |
| -------- | --------------------- |
| code     | 40000，有异常情况发生 |

##### b 提交卡片接口 

请求 ：http://www.gzfesco.cn/api/rcshcz/common/cardn/?openid=xxx&card1=1&card2=0&card3=1&card4=0

| **参数** | **取值范围**                 | **说明**               |
| -------- | ---------------------------- | ---------------------- |
| openid   |                              | 微信id                 |
| cardn    | card（1-4），代表第1张-第4张 | 1为已获得，0为没有获得 |

正常返回示例：{"code":20000,"message":"xxxx"}

| **参数**（字段code） | **取值范围** | **说明**     |
| -------------------- | ------------ | ------------ |
| 20000                |              | 提交数据成功 |

失败返回示例：

| **参数** | **说明**                                    |
| -------- | ------------------------------------------- |
| code     | 40000，代表请求到达服务器，但有异常情况发生 |



##### c 判断是否具有领取咖啡资格接口（条件1 集齐4个图片并判断时间。如果不满足，则跳转到重新体验页面，如满足则进入咖啡领取页面）

请求 ：http://www.gzfesco.cn/api/rcshcz/common/is_award/?openid=xxx

| **参数** | **取值范围** | **说明** |
| -------- | ------------ | -------- |
| openid   |              | 微信id   |

正常返回示例：{"code":20000,"message":"xxxx"}

| **参数**（字段code） | **取值范围** | **说明**                                    |
| -------------------- | ------------ | ------------------------------------------- |
| 20008                |              | 数据库找不到eid，意味着没有该玩家没有注册过 |
| 20015                |              | 玩家没有游戏记录，请为玩家开始游戏          |
| 20016                |              | 已具备领奖资格                              |
| 20017                |              | 不具备领奖资格                              |

失败返回示例：

| **参数** | **说明**                                    |
| -------- | ------------------------------------------- |
| code     | 40000，代表请求到达服务器，但有异常情况发生 |

##### d 判断是否领过咖啡接口（如果已领过咖啡，则弹出相应页面。如果未领过咖啡则弹出确认领取按钮）

请求 ：http://www.gzfesco.cn/api/rcshcz/common/is_awarded/?openid=xxx

| **参数** | **取值范围** | **说明** |
| -------- | ------------ | -------- |
| openid   |              | 微信id   |

正常返回示例：{"code":20000,"message":"xxxx"}

| **参数**（字段code） | **取值范围** | **说明**                                    |
| -------------------- | ------------ | ------------------------------------------- |
| 20009                |              | 已领过奖品                                  |
| 20008                |              | 数据库找不到eid，意味着没有该玩家没有注册过 |
| 20015                |              | 玩家没有游戏记录，请为玩家开始游戏          |
| 20018                |              | 未领奖                                      |

失败返回示例：

| **参数** | **说明**                                    |
| -------- | ------------------------------------------- |
| code     | 40000，代表请求到达服务器，但有异常情况发生 |

##### e 确认领过咖啡按钮。（咖啡游戏以项目id10存进数据库）

请求 ：http://www.gzfesco.cn/api/rcshcz/common/get_award/?openid=xxx

| **参数** | **取值范围** | **说明** |
| -------- | ------------ | -------- |
| openid   |              | 微信id   |

正常返回示例：{"code":20000,"message":"xxxx"}

| **参数**（字段code） | **取值范围** | **说明**                                    |
| -------------------- | ------------ | ------------------------------------------- |
| 20000                |              | 领奖成功                                    |
| 20008                |              | 数据库找不到eid，意味着没有该玩家没有注册过 |
| 20015                |              | 玩家没有游戏记录，请为玩家开始游戏          |

失败返回示例：

| **参数** | **说明**                                    |
| -------- | ------------------------------------------- |
| code     | 40000，代表请求到达服务器，但有异常情况发生 |

## 4 vr探秘

##### a 利用ffmpeg来实现图片合成视频，还在研究ing

## 5 新车合影小程序



## 6 tshirt拍照小程序



## 7 统计用接口（按钮点击事件）

请求 ：http://www.gzfesco.cn/api/rcshcz/common/stat1/?openid=xxx&pid=4

| **参数** | **取值范围** | **说明** |
| -------- | ------------ | -------- |
| openid   | 必填         | 微信id   |
| pid      | 1-10，必填   |          |

正常返回示例：{"code":20000,"message":"xxxx"}

| **参数**（字段code） | **取值范围** | **说明** |
| -------------------- | ------------ | -------- |
| 20000                |              | 领奖成功 |

失败返回示例：

| **参数** | **说明**                                    |
| -------- | ------------------------------------------- |
| code     | 40000，代表请求到达服务器，但有异常情况发生 |

## 8 统计用接口（ibeacon跳转事件）

请求 ：http://www.gzfesco.cn/api/rcshcz/common/stat2/?openid=xxx&pid=4

| **参数** | **取值范围** | **说明** |
| -------- | ------------ | -------- |
| openid   | 必填         | 微信id   |
| pid      | 1-6，必填    |          |

正常返回示例：{"code":20000,"message":"xxxx"}

| **参数**（字段code） | **取值范围** | **说明** |
| -------------------- | ------------ | -------- |
| 20000                |              | 领奖成功 |

失败返回示例：

| **参数** | **说明**                                    |
| -------- | ------------------------------------------- |
| code     | 40000，代表请求到达服务器，但有异常情况发生 |

9 统计excel

http://www.gzfesco.cn/api/rcshcz/common/getall_excel/

10 统计

http://www.gzfesco.cn/api/rcshcz/common/getall/



11 search1 seaech2接口

